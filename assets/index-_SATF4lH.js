(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function o(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=o(s);fetch(s.href,r)}})();let ae={},N=[],ce={},H={},y="NFC",v="EAST";const de="nflDivisionDashboard.settings.v1",ue="nflDivisionDashboard.history.v1",Le=20,be="data.json",F="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg'/%3E",Se=F,K=["localhost","127.0.0.1","::1"].includes(window.location.hostname);let L=[],x={},D=null,I={},g=[],ne=null,z=0;const Ie=["#04133b","#0b2a6e"],se={AFC:"https://upload.wikimedia.org/wikipedia/commons/7/7a/American_Football_Conference_logo.svg",NFC:"https://upload.wikimedia.org/wikipedia/commons/6/6f/National_Football_Conference_logo.svg"};let f=F,p=["#1e3a8a","#3b82f6"],$=null;function xe(){return Promise.resolve(window.domtoimage)}function Ce(e){if(typeof e!="string"||!e.startsWith("data:;base64,"))return e;const t=e.slice(13);return`data:${t.startsWith("PHN2Zy")||t.startsWith("PD94bWwg")?"image/svg+xml":"image/png"};base64,${t}`}function we(e){e&&e.querySelectorAll("img").forEach(t=>{const o=t.getAttribute("src")||"",n=Ce(o);n!==o&&(console.warn("[export] normalized typeless data URL",{alt:t.alt||"",originalPrefix:o.slice(0,40)}),t.setAttribute("src",n))})}function ke(e){var t;if(!e)return{summary:"Unknown export error"};if(e instanceof Event){const o=e.target||e.srcElement||null,n=o&&(o.currentSrc||o.src||((t=o.getAttribute)==null?void 0:t.call(o,"src")))||null;return{summary:`DOM event error: ${e.type||"unknown"}`,isTrusted:!!e.isTrusted,failedSrc:n,targetTag:o&&o.tagName?o.tagName:null}}return e instanceof Error?{summary:e.message||"Error",name:e.name||"Error",stack:e.stack||null}:typeof e=="object"?{summary:"Object error",...e}:{summary:String(e)}}function Be(e,t){return new Promise(o=>{if(!e){o({ok:!1,reason:"missing"});return}if(e.complete){const c=(e.naturalWidth||0)>0;o({ok:c,reason:c?"complete":"broken"});return}let n=!1;const s=c=>{n||(n=!0,e.removeEventListener("load",r),e.removeEventListener("error",l),clearTimeout(i),o(c))},r=()=>s({ok:!0,reason:"load"}),l=()=>s({ok:!1,reason:"error"}),i=setTimeout(()=>s({ok:!1,reason:"timeout"}),t);e.addEventListener("load",r,{once:!0}),e.addEventListener("error",l,{once:!0})})}async function Te(e){const t=Array.from(e.querySelectorAll("img"));if(!t.length)return;const o=await Promise.all(t.map(s=>Be(s,900))),n=[];o.forEach((s,r)=>{if(s.ok)return;const l=t[r];n.push({reason:s.reason,src:(l.currentSrc||l.src||"").slice(0,240),alt:l.alt||""}),l.src=F}),n.length?console.warn("[export] image preflight replaced problematic images",n):console.log("[export] image preflight all good")}function Ne(e){return e instanceof Element?!(e.id==="history-controls"||e.id==="history-popover"||e.id==="custom-panel"||e.id==="custom-overlay"||e.classList.contains("controls")||e.closest(".controls")||e.closest("#history-controls")||e.closest("#custom-panel")||e.closest("#custom-overlay")):!0}function Ae(){if(K)return"https://nfl.rprtd.app";const{protocol:e,host:t,pathname:o}=window.location;return`${e}//${t}${o||"/"}`}function M(){return`${y.toLowerCase()}_${v.toLowerCase()}`}function B(){return`${y} ${v}`}function A(e){if(!K||!e||e.startsWith("data:"))return e;try{const n=new URL(e,window.location.href).pathname||"";if(/\.(svg|png|jpe?g|gif|webp|avif)$/i.test(n))return e}catch{}const t=e.includes("?")?"&":"?";return`${e}${t}devcb=${Date.now()}`}function Y(){document.querySelectorAll(".conference-toggle").forEach(e=>{e.classList.toggle("active",e.dataset.value===y)}),document.querySelectorAll(".division-toggle-btn").forEach(e=>{e.classList.toggle("active",e.dataset.value===v)})}function De(){return P()[0]||{url:F,color:"#1e3a8a,#3b82f6",tint:null}}function $e(e){if(e===void 0)return;if(e===null)return null;const t=String(e).trim().toLowerCase();return!t||t==="null"||t==="none"?null:t==="white"||t==="black"?t:null}function P(){const e=M();return(ae[e]||[]).map(o=>{const n=Object.prototype.hasOwnProperty.call(o,"tint"),s=$e(o.tint);return{...o,hasExplicitTint:n,tint:n?s:me(o.label||"")?"white":null}})}function _(e){const t=(e||"").split(",");return[t[0]?t[0].trim():"#1e3a8a",t[1]?t[1].trim():"#3b82f6"]}function J(e){if(!e||typeof e!="string")return null;const t=e.trim().replace("#",""),o=t.length===3?t.split("").map(n=>n+n).join(""):t;return/^[0-9a-fA-F]{6}$/.test(o)?{r:parseInt(o.slice(0,2),16),g:parseInt(o.slice(2,4),16),b:parseInt(o.slice(4,6),16)}:null}function V(e){const t=o=>Math.max(0,Math.min(255,Math.round(o))).toString(16).padStart(2,"0");return`#${t(e.r)}${t(e.g)}${t(e.b)}`}function Pe(e){return .2126*e.r+.7152*e.g+.0722*e.b}function re(e){const t=J(e);if(!t)return"#1e3a8a";const o=Pe(t);if(o<=120)return e;const n=120/o;return V({r:t.r*n,g:t.g*n,b:t.b*n})}function le(e){const t=J(e);return t?V({r:t.r*.82,g:t.g*.9,b:t.b*1.15+12}):"#1e3a8a"}function ge(e){const t=Oe(),o=U(),n=!!(o&&o.hasExplicitTint&&o.tint===null),s=me(t)&&!n?Ie:e,r=re(le(s[0])),l=re(le(s[1]));if(r.toLowerCase()===l.toLowerCase()){const i=J(l)||{r:30,g:58,b:138};return[r,V({r:i.r*.85,g:i.g*.85,b:i.b*.85})]}return[r,l]}function X(){const e=document.querySelector(".logo-toggle.active");return e&&e.dataset.url==="custom"&&document.getElementById("custom-logo-url").value||f}function U(){if($)return $;const e=document.querySelector(".logo-toggle.active");if(e&&e.dataset.url==="custom")return null;const t=e?e.dataset.url:X();return P().find(o=>o.url===t)||null}function Oe(){const e=U();return e&&e.label||""}function me(e){const t=(e||"").trim().toLowerCase();return t.includes("fox")&&!t.includes("fox 29")}function T(e){document.querySelector(".header").classList.toggle("dark-logo-bg",!!e)}function He(){const e=U();return e?e.tint==="white":!1}function qe(e){const t=(e||"").replace("#","").trim(),o=t.length===3?t.split("").map(n=>n+n).join(""):t;return/^[0-9a-fA-F]{6}$/.test(o)?{r:parseInt(o.slice(0,2),16),g:parseInt(o.slice(2,4),16),b:parseInt(o.slice(4,6),16)}:null}function _e(e,t){const o=e.r-t.r,n=e.g-t.g,s=e.b-t.b;return Math.sqrt(o*o+n*n+s*s)}function Fe(e){return .2126*e.r+.7152*e.g+.0722*e.b}function Me(e,t){return new Promise(o=>{if(!e){o({needsLightHeader:!1,needsInvert:!1,invertToWhite:!0});return}const n=new Image;n.crossOrigin="anonymous",n.onload=()=>{try{const s=document.createElement("canvas");s.width=40,s.height=40;const r=s.getContext("2d",{willReadFrequently:!0});r.clearRect(0,0,40,40),r.drawImage(n,0,0,40,40);const l=r.getImageData(0,0,40,40).data;let i=0,c=0,a=0,d=0,m=0,h=0;for(let u=0;u<l.length;u+=4){const ee=l[u],te=l[u+1],oe=l[u+2];if(l[u+3]<20)continue;a++,.2126*ee+.7152*te+.0722*oe<48&&c++,d+=ee,m+=te,h+=oe,i++}if(!i||a<40){o({needsLightHeader:!1,needsInvert:!1,invertToWhite:!0});return}const b=c/i,C={r:Math.round(d/i),g:Math.round(m/i),b:Math.round(h/i)},w=qe(t)||{r:30,g:58,b:138},k=_e(C,w)<62,O=Fe(w)<150;o({needsLightHeader:b>.65,needsInvert:k,invertToWhite:O})}catch{o({needsLightHeader:!1,needsInvert:!1,invertToWhite:!0})}},n.onerror=()=>o({needsLightHeader:!1,needsInvert:!1,invertToWhite:!0}),n.src=A(e)})}function fe(e,t){const o=++z,n=document.getElementById("network-logo"),s=document.querySelector(".header"),r=U(),l=r?r.tint??null:null,i=!!(r&&r.hasExplicitTint&&l===null),c=!i&&He(),a=!!(r&&!r.hasExplicitTint&&/fox/i.test(r.label||""));if(n.classList.toggle("fox-pop-logo",a),s&&s.classList.toggle("fox-pop-header",a),console.log("[contrast] start",{requestId:o,url:e,bgHex:t,stationLabel:r?r.label:null,tint:l,hasExplicitTint:!!(r&&r.hasExplicitTint),disableAutoTint:i,forceWhiteFoxLogo:c,foxLogoPop:a}),n.classList.toggle("logo-white-invert",l==="white"||c),n.classList.remove("logo-black-invert"),i){console.log("[contrast] branch: explicit-null-no-tint"),n.classList.remove("logo-white-invert"),n.classList.remove("logo-black-invert"),T(!1);return}if(l==="black"){console.log("[contrast] branch: force-black"),n.classList.remove("logo-white-invert"),n.classList.add("logo-black-invert"),T(!1);return}if(l==="white"||c){console.log("[contrast] branch: force-white"),T(!1);return}console.log("[contrast] branch: analyze-profile"),T(!1),Me(e,t).then(d=>{if(o!==z){console.log("[contrast] branch: stale-request-skip",{requestId:o,activeRequestId:z});return}if(console.log("[contrast] profile",d),d.needsInvert&&!i){console.log("[contrast] branch: auto-invert",{invertToWhite:d.invertToWhite}),n.classList.toggle("logo-white-invert",d.invertToWhite),n.classList.toggle("logo-black-invert",!d.invertToWhite),T(!1);return}console.log("[contrast] branch: no-invert",{needsLightHeader:d.needsLightHeader}),n.classList.remove("logo-white-invert"),n.classList.remove("logo-black-invert"),T(d.needsLightHeader)})}function S(){const e=M();N.length&&(I[e]={title:document.getElementById("custom-title").value,subtitle:document.getElementById("custom-subtitle").value,order:[...L],values:{...x},logoUrl:f,colors:[...p]})}function pe(){return{selectedConference:y,selectedDivision:v,divisionStates:JSON.parse(JSON.stringify(I)),selectedLogoUrl:f,selectedHeaderColors:[...p],customLogoInput:document.getElementById("custom-logo-url").value||""}}function E(e={}){const{skipHistory:t=!1}=e;try{localStorage.setItem(de,JSON.stringify(pe())),t||Ge()}catch(o){console.warn("Unable to save settings:",o)}}function Ue(){try{const e=localStorage.getItem(de);if(!e)return;const t=JSON.parse(e);y=t.selectedConference||y,v=t.selectedDivision||v,I=t.divisionStates||{},f=t.selectedLogoUrl||f,p=Array.isArray(t.selectedHeaderColors)&&t.selectedHeaderColors.length===2?t.selectedHeaderColors:p,document.getElementById("custom-logo-url").value=t.customLogoInput||""}catch(e){console.warn("Unable to restore settings:",e)}}function Z(){try{localStorage.setItem(ue,JSON.stringify(g))}catch(e){console.warn("Unable to save history:",e)}}function We(){try{const e=localStorage.getItem(ue);g=e?JSON.parse(e):[],g=g.map(t=>{if(t.uniqueKey)return t;const o=t.state||{};return{...t,uniqueKey:he(o)}})}catch{g=[]}}function G(e){return e===null||typeof e!="object"?JSON.stringify(e):Array.isArray(e)?`[${e.map(o=>G(o)).join(",")}]`:`{${Object.keys(e).sort().map(o=>`${JSON.stringify(o)}:${G(e[o])}`).join(",")}}`}function Re(e){let t=2166136261;for(let o=0;o<e.length;o++)t^=e.charCodeAt(o),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return(t>>>0).toString(36)}function he(e){return Re(G(e))}function ze(e){return new Date(e).toLocaleString([],{dateStyle:"short",timeStyle:"short"})}function W(){const e=document.getElementById("history-controls"),t=document.getElementById("history-popover"),o=document.getElementById("history-toggle-btn");e.style.display=g.length?"flex":"none",o.textContent=g.length?`Previous ${g.length}`:"Snapshots",t.innerHTML="",g.forEach(n=>{var w,k,O;const s=n.conference||((w=n.state)==null?void 0:w.selectedConference)||"",r=n.division||((k=n.state)==null?void 0:k.selectedDivision)||"",l=n.stationLogoUrl||((O=n.state)==null?void 0:O.selectedLogoUrl)||"",i=document.createElement("div");i.className=`history-item${n.auto?" auto":""}`,i.dataset.id=n.id;const c=document.createElement("div");c.className="history-item-top";const a=document.createElement("div");if(a.className="history-item-logos",se[s]){const u=document.createElement("img");u.className="history-conf-logo",u.alt=s||"Conference",u.loading="lazy",u.decoding="async",u.dataset.src=se[s],a.appendChild(u)}if(l){const u=document.createElement("img");u.className="history-station-logo",u.alt=n.stationLabel||"Station",u.loading="lazy",u.decoding="async",u.dataset.src=l,a.appendChild(u)}const d=document.createElement("span");d.className="history-division-badge",d.textContent=`${s} ${r}`.trim(),a.appendChild(d);const m=document.createElement("button");m.className="history-delete-btn",m.type="button",m.textContent="×",m.addEventListener("click",u=>{u.stopPropagation(),Ye(n.id)}),c.appendChild(a),c.appendChild(m),i.appendChild(c);const h=document.createElement("div");h.className="history-item-title",h.textContent=n.title||"NFL Meme War",i.appendChild(h);const b=document.createElement("div");b.className="history-item-subtitle",b.textContent=n.subtitle||`In the ${s} ${r}`.trim(),i.appendChild(b);const C=document.createElement("div");C.className="history-item-date",C.textContent=ze(n.createdAt||Number(n.id)),i.appendChild(C),i.addEventListener("click",()=>{Ke(n.id),document.getElementById("history-popover").classList.remove("visible")}),t.appendChild(i)}),t.classList.contains("visible")&&ye()}function ye(){document.querySelectorAll("#history-popover img[data-src]").forEach(e=>{e.src||(e.src=A(e.dataset.src)),e.removeAttribute("data-src")})}function je(e=!1){S();const t=pe(),o=he(t);if(g[0]&&g[0].uniqueKey===o)return;const n=new Date,s=document.querySelector(".logo-toggle.active"),r=n.toISOString(),l={id:`snap_${o}`,createdAt:r,conference:y,division:v,stationLabel:s?s.textContent.trim():"",stationLogoUrl:X(),title:document.getElementById("custom-title").value||"NFL Meme War",subtitle:document.getElementById("custom-subtitle").value||`In the ${B()}`,auto:!!e,state:t,uniqueKey:o},i=g.findIndex(c=>c.uniqueKey===o);i>=0&&g.splice(i,1),g.unshift(l),g=g.slice(0,Le),Z(),W()}function Ge(){clearTimeout(ne),ne=setTimeout(()=>je(!0),1200)}function Ke(e){const t=g.findIndex(r=>r.id===e),o=t>=0?g[t]:null;if(!o)return;const n=o.state||{};y=n.selectedConference||y,v=n.selectedDivision||v,I=n.divisionStates||{},f=n.selectedLogoUrl||f,p=Array.isArray(n.selectedHeaderColors)&&n.selectedHeaderColors.length===2?n.selectedHeaderColors:p,document.getElementById("custom-logo-url").value=n.customLogoInput||"",Y();const s=new Date().toISOString();o.createdAt=s,g.splice(t,1),g.unshift(o),Z(),W(),q().then(()=>{E({skipHistory:!0})})}function Ye(e){g=g.filter(t=>t.id!==e),Z(),W()}function Je(){const e=M(),t=I[e],o=De(),n=P();if(L=N.map(s=>s.team),x={},f=o.url,p=_(o.color),document.getElementById("custom-title").value="",document.getElementById("custom-subtitle").value=`In the ${B()}`,t){document.getElementById("custom-title").value=t.title||"",document.getElementById("custom-subtitle").value=t.subtitle||`In the ${B()}`,L=t.order&&t.order.length?[...t.order]:L,x=t.values?{...t.values}:{},f=t.logoUrl||f,p=t.colors&&t.colors.length===2?[...t.colors]:p;const s=n.some(i=>i.url===f),r=(document.getElementById("custom-logo-url").value||"").trim();!s&&!(!!r&&r===f)&&(f=o.url,p=_(o.color),I[e]&&(I[e].logoUrl=f,I[e].colors=[...p]))}}function ve(){const e=document.getElementById("division-station-options");e.innerHTML="";const t=document.createElement("div");t.className="logo-group";const o=document.createElement("div");o.className="logo-group-label",o.textContent=`${B()} Top Stations`,t.appendChild(o);const n=document.createElement("div");n.className="logo-group-buttons",P().forEach(l=>{const i=document.createElement("button");i.className="logo-toggle",i.dataset.url=l.url,i.dataset.color=l.color,i.dataset.tint=l.tint==null?"null":String(l.tint),i.textContent=l.label,l.url===f&&i.classList.add("active"),i.addEventListener("click",j),i.addEventListener("mouseenter",()=>Ve(l)),i.addEventListener("mouseleave",Xe),n.appendChild(i)}),t.appendChild(n),e.appendChild(t);const s=document.querySelector('.logo-toggle[data-url="custom"]');if(s){const l=P().some(i=>i.url===f);s.classList.toggle("active",!l),s.removeEventListener("click",j),s.addEventListener("click",j)}const r=document.getElementById("custom-logo-url");s&&s.classList.contains("active")?r.classList.add("visible"):r.classList.remove("visible")}function Ve(e){if(!e||!e.url)return;const t=document.getElementById("network-logo"),o=document.querySelector(".header");if(!t||!o)return;$=e;const n=_(e.color||p.join(",")),s=ge(n);t.src=A(e.url),t.alt=`${e.label||B()} Network Logo`,fe(e.url,n[0]),o.style.background=`linear-gradient(135deg, ${s[0]} 0%, ${s[1]} 100%)`}function Xe(){$=null,Q()}function j(e){$=null;const t=e.currentTarget;document.querySelectorAll(".logo-toggle").forEach(n=>n.classList.remove("active")),t.classList.add("active");const o=document.getElementById("custom-logo-url");t.dataset.url==="custom"?(o.classList.add("visible"),o.focus()):(o.classList.remove("visible"),f=t.dataset.url),p=_(t.dataset.color),E()}function Ze(){const e=document.getElementById("custom-panel"),t=document.getElementById("custom-overlay");e.classList.add("visible"),t.classList.add("visible"),ve(),R()}function Ee(){document.getElementById("custom-panel").classList.remove("visible"),document.getElementById("custom-overlay").classList.remove("visible")}function R(){const e=document.getElementById("custom-team-inputs");e.innerHTML="",L.forEach((t,o)=>{const n=N.find(c=>c.team===t);if(!n)return;const s=document.createElement("div");s.className="custom-team-row",s.style.background=n.color,s.draggable=!0,s.dataset.team=t,s.dataset.index=o;const r=document.createElement("span");r.className="drag-handle",r.textContent="☰";const l=document.createElement("span");l.className="team-name",l.textContent=t;const i=document.createElement("input");i.type="text",i.placeholder="Value",i.value=x[t]||"",i.addEventListener("input",c=>{x[t]=c.target.value,S(),E()}),s.appendChild(r),s.appendChild(l),s.appendChild(i),e.appendChild(s),s.addEventListener("dragstart",c=>{D=o,s.classList.add("dragging"),c.dataTransfer.effectAllowed="move"}),s.addEventListener("dragend",()=>{s.classList.remove("dragging"),e.querySelectorAll(".custom-team-row").forEach(c=>c.classList.remove("drag-over"))}),s.addEventListener("dragover",c=>{c.preventDefault(),c.dataTransfer.dropEffect="move",e.querySelectorAll(".custom-team-row").forEach(a=>a.classList.remove("drag-over")),s.classList.add("drag-over")}),s.addEventListener("drop",c=>{c.preventDefault(),s.classList.remove("drag-over");const a=parseInt(s.dataset.index,10);if(D!==null&&D!==a){const d=L.splice(D,1)[0];L.splice(a,0,d),R()}D=null})})}function ie(e){L.sort((t,o)=>{const n=x[t]||"",s=x[o]||"",r=parseFloat(n),l=parseFloat(s);return!isNaN(r)&&!isNaN(l)?e?r-l:l-r:e?n.localeCompare(s):s.localeCompare(n)}),R(),S(),E()}function Q(){const e=document.getElementById("custom-title").value||"NFL Meme War",t=document.getElementById("custom-subtitle").value||`In the ${B()}`,o=X();document.getElementById("page-title").textContent=e,document.getElementById("page-subtitle").textContent=t;const n=document.getElementById("network-logo");n.src=A(o),n.alt=`${B()} Network Logo`,fe(o,p[0]);const s=ge(p);document.querySelector(".header").style.background=`linear-gradient(135deg, ${s[0]} 0%, ${s[1]} 100%)`;const r=document.getElementById("teams-container");if(r.innerHTML="",!N.length){r.innerHTML='<div style="color: white; text-align: center; padding: 50px;">No team data found for this division</div>';return}L.forEach((l,i)=>{const c=N.find(b=>b.team===l);if(!c)return;const a=document.createElement("div");a.className="team-row",a.style.backgroundColor=c.color,a.style.zIndex=L.length-i;const d=document.createElement("img");d.crossOrigin="anonymous",d.src=A(c.logo),d.alt=`${c.team} Logo`,d.className="team-logo";const m=document.createElement("div");m.className="points";const h=x[l]||"";h.length>10?m.style.fontSize="60px":h.length>6&&(m.style.fontSize="80px"),m.textContent=h,a.appendChild(d),a.appendChild(m),r.appendChild(a)})}function Qe(){Ee(),S(),Q(),E()}function et(e){if(H[e])return Promise.resolve(H[e]);const t=ce[e]||[];return H[e]={teams:t},Promise.resolve(H[e])}function q(){const e=M();return et(e).then(t=>{N=t.teams||[],Y(),Je(),ve(),R(),Q()})}function tt(){console.log("[export] clicked");const e=document.getElementById("export-btn"),t=document.querySelector(".controls"),o=document.getElementById("history-controls"),n=document.getElementById("history-popover"),s=document.querySelector(".container");if(!t||!s||!e){console.error("[export] missing refs",{hasControls:!!t,hasContainer:!!s,hasButton:!!e}),alert("Export failed: missing UI container.");return}console.log("[export] refs ok",{containerSize:{width:s.offsetWidth,height:s.offsetHeight},imgCount:s.querySelectorAll("img").length});const r=t.style.display,l=o?o.style.display:"",i=!!n&&n.classList.contains("visible"),c=s.style.position;let a=null;t.style.display="none",o&&(o.style.display="none"),n&&n.classList.remove("visible"),s.style.position="relative",a=document.createElement("div"),a.id="export-url-badge",a.textContent=Ae(),a.style.position="absolute",a.style.left="50%",a.style.bottom="18px",a.style.transform="translateX(-50%)",a.style.fontFamily="Arial Black, Arial, sans-serif",a.style.fontSize="24px",a.style.fontWeight="700",a.style.letterSpacing="0.5px",a.style.color="rgba(255,255,255,0.75)",a.style.textShadow="0 2px 8px rgba(0,0,0,0.55)",a.style.pointerEvents="none",a.style.zIndex="9999",s.appendChild(a),e.textContent="Exporting...",e.disabled=!0,console.log("[export] ui locked"),setTimeout(()=>{console.log("[export] normalize sources start"),we(s),console.log("[export] normalize sources done"),Te(s).then(()=>{console.log("[export] loading dom-to-image"),xe().then(d=>(console.log("[export] dom-to-image loaded",{hasToPng:!!(d&&d.toPng)}),console.log("[export] toPng start"),d.toPng(s,{width:1080,height:1920,quality:1,cacheBust:!0,imagePlaceholder:Se,filter:Ne,style:{margin:"0",padding:"0"}}))).then(d=>{console.log("[export] toPng resolved",{dataUrlPrefix:typeof d=="string"?d.slice(0,30):typeof d});const m=document.createElement("a"),h=new Date,b=String(h.getMonth()+1).padStart(2,"0"),C=String(h.getDate()).padStart(2,"0"),w=String(h.getFullYear()).slice(-2),k=`${y}${v}Meme-${b}-${C}-${w}.png`;m.download=k,m.href=d,m.click(),console.log("[export] download triggered",{filename:k})}).catch(d=>{const m=ke(d);window.lastExportError=m,console.error("[export] failed",m),alert("Error exporting image. Please try again.")}).finally(()=>{console.log("[export] finally restore ui"),a&&a.parentNode&&a.parentNode.removeChild(a),s.style.position=c,t.style.display=r||"flex",o&&(o.style.display=l),n&&i&&n.classList.add("visible"),e.textContent="Export PNG",e.disabled=!1,console.log("[export] done")})}).catch(d=>{console.error("[export] preflight failed",d),t.style.display=r||"flex",o&&(o.style.display=l),n&&i&&n.classList.add("visible"),e.textContent="Export PNG",e.disabled=!1})},300)}fetch(A(be),{cache:K?"no-store":"default"}).then(e=>{if(!e.ok)throw new Error("Missing data.json");return e.json()}).then(e=>{ce=e.teamsByDivision||{},ae=e.stationsByDivision||{},Ue(),We(),W(),Y(),document.querySelectorAll(".conference-toggle").forEach(t=>{t.addEventListener("click",()=>{const o=t.dataset.value;o!==y&&(S(),y=o,q().then(()=>E()))})}),document.querySelectorAll(".division-toggle-btn").forEach(t=>{t.addEventListener("click",()=>{const o=t.dataset.value;o!==v&&(S(),v=o,q().then(()=>E()))})}),document.getElementById("custom-logo-url").addEventListener("input",t=>{var o;((o=document.querySelector(".logo-toggle.active"))==null?void 0:o.dataset.url)==="custom"&&(f=t.target.value.trim()||f,S(),E())}),document.getElementById("custom-title").addEventListener("input",()=>{S(),E()}),document.getElementById("custom-subtitle").addEventListener("input",()=>{S(),E()}),document.getElementById("sort-asc-btn").addEventListener("click",()=>ie(!0)),document.getElementById("sort-desc-btn").addEventListener("click",()=>ie(!1)),document.getElementById("custom-apply-btn").addEventListener("click",Qe),document.getElementById("custom-overlay").addEventListener("click",Ee),document.getElementById("edit-btn").addEventListener("click",Ze),document.getElementById("export-btn").addEventListener("click",tt),document.getElementById("history-toggle-btn").addEventListener("click",t=>{t.stopPropagation();const o=document.getElementById("history-popover");o.classList.toggle("visible"),o.classList.contains("visible")&&ye()}),document.getElementById("history-popover").addEventListener("click",t=>{t.stopPropagation()}),document.addEventListener("click",()=>{document.getElementById("history-popover").classList.remove("visible")}),q().then(()=>E())}).catch(e=>{console.error("Error loading data:",e),document.getElementById("teams-container").innerHTML='<div style="color: white; text-align: center; padding: 50px;">Error loading data</div>'});
